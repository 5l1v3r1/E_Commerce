function cov_sweksfh9v(){var path="C:\\Users\\bolorundurovb\\Documents\\Web Projects\\E_Commerce\\routes\\checkout.js";var hash="3e48dfb331a3cb29119400dc6bd6165ebe435893";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\bolorundurovb\\Documents\\Web Projects\\E_Commerce\\routes\\checkout.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:13},end:{line:2,column:29}},"2":{start:{line:3,column:14},end:{line:3,column:40}},"3":{start:{line:4,column:17},end:{line:4,column:50}},"4":{start:{line:5,column:15},end:{line:5,column:34}},"5":{start:{line:6,column:17},end:{line:6,column:31}},"6":{start:{line:7,column:12},end:{line:7,column:35}},"7":{start:{line:9,column:0},end:{line:15,column:4}},"8":{start:{line:17,column:19},end:{line:33,column:1}},"9":{start:{line:18,column:17},end:{line:18,column:45}},"10":{start:{line:20,column:15},end:{line:20,column:32}},"11":{start:{line:22,column:2},end:{line:32,column:3}},"12":{start:{line:24,column:20},end:{line:24,column:25}},"13":{start:{line:26,column:6},end:{line:26,column:24}},"14":{start:{line:27,column:6},end:{line:27,column:29}},"15":{start:{line:28,column:6},end:{line:28,column:13}},"16":{start:{line:31,column:6},end:{line:31,column:60}},"17":{start:{line:36,column:0},end:{line:81,column:3}},"18":{start:{line:37,column:2},end:{line:61,column:3}},"19":{start:{line:38,column:4},end:{line:56,column:5}},"20":{start:{line:40,column:8},end:{line:40,column:71}},"21":{start:{line:43,column:0},end:{line:51,column:3}},"22":{start:{line:45,column:2},end:{line:45,column:35}},"23":{start:{line:46,column:2},end:{line:46,column:69}},"24":{start:{line:49,column:2},end:{line:49,column:32}},"25":{start:{line:50,column:2},end:{line:50,column:22}},"26":{start:{line:54,column:8},end:{line:54,column:38}},"27":{start:{line:64,column:11},end:{line:64,column:27}},"28":{start:{line:65,column:20},end:{line:65,column:39}},"29":{start:{line:66,column:18},end:{line:66,column:19}},"30":{start:{line:67,column:19},end:{line:67,column:20}},"31":{start:{line:69,column:2},end:{line:73,column:3}},"32":{start:{line:70,column:4},end:{line:70,column:39}},"33":{start:{line:71,column:4},end:{line:71,column:49}},"34":{start:{line:72,column:5},end:{line:72,column:36}},"35":{start:{line:74,column:0},end:{line:74,column:26}},"36":{start:{line:77,column:17},end:{line:77,column:23}},"37":{start:{line:79,column:2},end:{line:79,column:186}},"38":{start:{line:80,column:2},end:{line:80,column:20}},"39":{start:{line:83,column:0},end:{line:85,column:2}},"40":{start:{line:84,column:2},end:{line:84,column:21}},"41":{start:{line:87,column:0},end:{line:87,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:19},end:{line:17,column:20}},loc:{start:{line:17,column:39},end:{line:33,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:36,column:28},end:{line:36,column:29}},loc:{start:{line:36,column:48},end:{line:81,column:1}},line:36},"2":{name:"(anonymous_2)",decl:{start:{line:37,column:37},end:{line:37,column:38}},loc:{start:{line:37,column:51},end:{line:61,column:1}},line:37},"3":{name:"(anonymous_3)",decl:{start:{line:43,column:11},end:{line:43,column:12}},loc:{start:{line:43,column:41},end:{line:51,column:1}},line:43},"4":{name:"(anonymous_4)",decl:{start:{line:83,column:36},end:{line:83,column:37}},loc:{start:{line:83,column:56},end:{line:85,column:1}},line:83}},branchMap:{"0":{loc:{start:{line:22,column:2},end:{line:32,column:3}},type:"if",locations:[{start:{line:22,column:2},end:{line:32,column:3}},{start:{line:22,column:2},end:{line:32,column:3}}],line:22},"1":{loc:{start:{line:38,column:4},end:{line:56,column:5}},type:"if",locations:[{start:{line:38,column:4},end:{line:56,column:5}},{start:{line:38,column:4},end:{line:56,column:5}}],line:38},"2":{loc:{start:{line:46,column:21},end:{line:46,column:68}},type:"cond-expr",locations:[{start:{line:46,column:60},end:{line:46,column:63}},{start:{line:46,column:66},end:{line:46,column:68}}],line:46},"3":{loc:{start:{line:49,column:13},end:{line:49,column:30}},type:"binary-expr",locations:[{start:{line:49,column:13},end:{line:49,column:23}},{start:{line:49,column:27},end:{line:49,column:30}}],line:49}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3e48dfb331a3cb29119400dc6bd6165ebe435893"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_sweksfh9v=function(){return actualCoverage;};return actualCoverage;}cov_sweksfh9v();var express=(cov_sweksfh9v().s[0]++,require('express'));var router=(cov_sweksfh9v().s[1]++,express.Router());var session=(cov_sweksfh9v().s[2]++,require('express-session'));var MongoStore=(cov_sweksfh9v().s[3]++,require('connect-mongo')(session));var mongoose=(cov_sweksfh9v().s[4]++,require('mongoose'));var Handlebars=(cov_sweksfh9v().s[5]++,require('hbs'));const jwt=(cov_sweksfh9v().s[6]++,require('jsonwebtoken'));cov_sweksfh9v().s[7]++;router.use(session({secret:'secret',resave:false,saveUninitialized:false,store:new MongoStore({mongooseConnection:mongoose.connection}),cookie:{maxAge:180*60*1000}}));cov_sweksfh9v().s[8]++;const checkToken=(req,res,next)=>{cov_sweksfh9v().f[0]++;const header=(cov_sweksfh9v().s[9]++,req.headers['authorization']);const heads=(cov_sweksfh9v().s[10]++,req.cookies.token);cov_sweksfh9v().s[11]++;if(typeof heads!=='undefined'){cov_sweksfh9v().b[0][0]++;//const bearer = header.split(' ');
const token=(cov_sweksfh9v().s[12]++,heads);cov_sweksfh9v().s[13]++;req.token=token;cov_sweksfh9v().s[14]++;console.log(req.token);cov_sweksfh9v().s[15]++;next();}else{cov_sweksfh9v().b[0][1]++;cov_sweksfh9v().s[16]++;//If header is undefined return Forbidden (403)
res.render('./login',{message:'You need to log in'});}};/* GET home page. */cov_sweksfh9v().s[17]++;router.get('/',checkToken,(req,res,next)=>{cov_sweksfh9v().f[1]++;cov_sweksfh9v().s[18]++;jwt.verify(req.token,'secretkey',(err,res)=>{cov_sweksfh9v().f[2]++;cov_sweksfh9v().s[19]++;if(err){cov_sweksfh9v().b[1][0]++;cov_sweksfh9v().s[20]++;//If error send Forbidden (403)
console.log('ERROR: Could not connect to the protected route');// error handler
cov_sweksfh9v().s[21]++;router.use(function(err,req,res,next){cov_sweksfh9v().f[3]++;cov_sweksfh9v().s[22]++;// set locals, only providing error in development
res.locals.message=err.message;cov_sweksfh9v().s[23]++;res.locals.error=req.app.get('env')==='development'?(cov_sweksfh9v().b[2][0]++,err):(cov_sweksfh9v().b[2][1]++,{});// render the error page
cov_sweksfh9v().s[24]++;res.status((cov_sweksfh9v().b[3][0]++,err.status)||(cov_sweksfh9v().b[3][1]++,403));cov_sweksfh9v().s[25]++;res.render('error');});}else{cov_sweksfh9v().b[1][1]++;cov_sweksfh9v().s[26]++;//If token is successfully verified, we can send the autorized data 
console.log('Token verified');}});var cart=(cov_sweksfh9v().s[27]++,req.session.cart);var displayCart=(cov_sweksfh9v().s[28]++,{items:[],total:0});var total=(cov_sweksfh9v().s[29]++,0);var totalQ=(cov_sweksfh9v().s[30]++,0);cov_sweksfh9v().s[31]++;for(var item in cart){cov_sweksfh9v().s[32]++;displayCart.items.push(cart[item]);cov_sweksfh9v().s[33]++;total+=cart[item].qty*cart[item].price;cov_sweksfh9v().s[34]++;totalQ+=cart[item].qty*1;}cov_sweksfh9v().s[35]++;displayCart.total=total;var totalQty=(cov_sweksfh9v().s[36]++,totalQ);cov_sweksfh9v().s[37]++;res.render('checkout',{title:'E-Commerce || Checkout',email:req.cookies.email,cart:cart,totalQty:totalQty,cartTotal:total,namee:req.cookies.cc,quant:req.cookies.quant});cov_sweksfh9v().s[38]++;console.log(cart);});cov_sweksfh9v().s[39]++;Handlebars.registerHelper('totalP',function(price,qty){cov_sweksfh9v().f[4]++;cov_sweksfh9v().s[40]++;return price*qty;});cov_sweksfh9v().s[41]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoZWNrb3V0LmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwic2Vzc2lvbiIsIk1vbmdvU3RvcmUiLCJtb25nb29zZSIsIkhhbmRsZWJhcnMiLCJqd3QiLCJ1c2UiLCJzZWNyZXQiLCJyZXNhdmUiLCJzYXZlVW5pbml0aWFsaXplZCIsInN0b3JlIiwibW9uZ29vc2VDb25uZWN0aW9uIiwiY29ubmVjdGlvbiIsImNvb2tpZSIsIm1heEFnZSIsImNoZWNrVG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiaGVhZGVyIiwiaGVhZGVycyIsImhlYWRzIiwiY29va2llcyIsInRva2VuIiwiY29uc29sZSIsImxvZyIsInJlbmRlciIsIm1lc3NhZ2UiLCJnZXQiLCJ2ZXJpZnkiLCJlcnIiLCJsb2NhbHMiLCJlcnJvciIsImFwcCIsInN0YXR1cyIsImNhcnQiLCJkaXNwbGF5Q2FydCIsIml0ZW1zIiwidG90YWwiLCJ0b3RhbFEiLCJpdGVtIiwicHVzaCIsInF0eSIsInByaWNlIiwidG90YWxRdHkiLCJ0aXRsZSIsImVtYWlsIiwiY2FydFRvdGFsIiwibmFtZWUiLCJjYyIsInF1YW50IiwicmVnaXN0ZXJIZWxwZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoidzFKQUFBLEdBQUlBLENBQUFBLE9BQU8seUJBQUdDLE9BQU8sQ0FBQyxTQUFELENBQVYsQ0FBWCxDQUNBLEdBQUlDLENBQUFBLE1BQU0seUJBQUdGLE9BQU8sQ0FBQ0csTUFBUixFQUFILENBQVYsQ0FDQSxHQUFJQyxDQUFBQSxPQUFPLHlCQUFHSCxPQUFPLENBQUMsaUJBQUQsQ0FBVixDQUFYLENBQ0EsR0FBSUksQ0FBQUEsVUFBVSx5QkFBR0osT0FBTyxDQUFDLGVBQUQsQ0FBUCxDQUF5QkcsT0FBekIsQ0FBSCxDQUFkLENBQ0EsR0FBSUUsQ0FBQUEsUUFBUSx5QkFBR0wsT0FBTyxDQUFDLFVBQUQsQ0FBVixDQUFaLENBQ0EsR0FBSU0sQ0FBQUEs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TSxDQUFDQyxPQUFQLENBQWlCdEQsTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxudmFyIHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcbnZhciBzZXNzaW9uID0gcmVxdWlyZSgnZXhwcmVzcy1zZXNzaW9uJyk7XHJcbnZhciBNb25nb1N0b3JlID0gcmVxdWlyZSgnY29ubmVjdC1tb25nbycpKHNlc3Npb24pOyBcclxudmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxudmFyIEhhbmRsZWJhcnMgPSByZXF1aXJlKCdoYnMnKTtcclxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcblxyXG5yb3V0ZXIudXNlKHNlc3Npb24oe1xyXG4gIHNlY3JldDogJ3NlY3JldCcsXHJcbiAgcmVzYXZlOiBmYWxzZSxcclxuICBzYXZlVW5pbml0aWFsaXplZDogZmFsc2UsXHJcbiAgc3RvcmU6IG5ldyBNb25nb1N0b3JlKHsgbW9uZ29vc2VDb25uZWN0aW9uOiBtb25nb29zZS5jb25uZWN0aW9uIH0pLFxyXG4gIGNvb2tpZTogeyBtYXhBZ2U6IDE4MCo2MCoxMDAwIH1cclxufSkpO1xyXG5cclxuY29uc3QgY2hlY2tUb2tlbiA9IChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGNvbnN0IGhlYWRlciA9IHJlcS5oZWFkZXJzWydhdXRob3JpemF0aW9uJ107XHJcblxyXG4gY29uc3QgaGVhZHMgPSByZXEuY29va2llcy50b2tlbjtcclxuXHJcbiAgaWYodHlwZW9mIGhlYWRzICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAvL2NvbnN0IGJlYXJlciA9IGhlYWRlci5zcGxpdCgnICcpO1xyXG4gICAgICBjb25zdCB0b2tlbiA9IGhlYWRzO1xyXG5cclxuICAgICAgcmVxLnRva2VuID0gdG9rZW47XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlcS50b2tlbik7XHJcbiAgICAgIG5leHQoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgICAvL0lmIGhlYWRlciBpcyB1bmRlZmluZWQgcmV0dXJuIEZvcmJpZGRlbiAoNDAzKVxyXG4gICAgICByZXMucmVuZGVyKCcuL2xvZ2luJywge21lc3NhZ2U6J1lvdSBuZWVkIHRvIGxvZyBpbid9KTtcclxuICB9XHJcbn1cclxuXHJcbi8qIEdFVCBob21lIHBhZ2UuICovXHJcbnJvdXRlci5nZXQoJy8nLCBjaGVja1Rva2VuLCAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICBqd3QudmVyaWZ5KHJlcS50b2tlbiwgJ3NlY3JldGtleScsIChlcnIsIHJlcykgPT4ge1xyXG4gICAgaWYoZXJyKXtcclxuICAgICAgICAvL0lmIGVycm9yIHNlbmQgRm9yYmlkZGVuICg0MDMpXHJcbiAgICAgICAgY29uc29sZS5sb2coJ0VSUk9SOiBDb3VsZCBub3QgY29ubmVjdCB0byB0aGUgcHJvdGVjdGVkIHJvdXRlJyk7XHJcbiAgICAgICAgXHJcbiAgLy8gZXJyb3IgaGFuZGxlclxyXG5yb3V0ZXIudXNlKGZ1bmN0aW9uKGVyciwgcmVxLCByZXMsIG5leHQpIHtcclxuICAvLyBzZXQgbG9jYWxzLCBvbmx5IHByb3ZpZGluZyBlcnJvciBpbiBkZXZlbG9wbWVudFxyXG4gIHJlcy5sb2NhbHMubWVzc2FnZSA9IGVyci5tZXNzYWdlO1xyXG4gIHJlcy5sb2NhbHMuZXJyb3IgPSByZXEuYXBwLmdldCgnZW52JykgPT09ICdkZXZlbG9wbWVudCcgPyBlcnIgOiB7fTtcclxuXHJcbiAgLy8gcmVuZGVyIHRoZSBlcnJvciBwYWdlXHJcbiAgcmVzLnN0YXR1cyhlcnIuc3RhdHVzIHx8IDQwMyk7XHJcbiAgcmVzLnJlbmRlcignZXJyb3InKTtcclxufSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vSWYgdG9rZW4gaXMgc3VjY2Vzc2Z1bGx5IHZlcmlmaWVkLCB3ZSBjYW4gc2VuZCB0aGUgYXV0b3JpemVkIGRhdGEgXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1Rva2VuIHZlcmlmaWVkJyk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcbiAgXHJcbiAgXHJcbiAgXHJcblxyXG59KTtcclxuXHJcblxyXG52YXIgY2FydCA9IHJlcS5zZXNzaW9uLmNhcnQ7XHJcbiAgdmFyIGRpc3BsYXlDYXJ0ID0ge2l0ZW1zOltdLCB0b3RhbDowfVxyXG4gICAgICAgIHZhciB0b3RhbD0wO1xyXG4gICAgICAgIHZhciB0b3RhbFE9MDtcclxuXHJcbiAgZm9yKHZhciBpdGVtIGluIGNhcnQpe1xyXG4gICAgZGlzcGxheUNhcnQuaXRlbXMucHVzaChjYXJ0W2l0ZW1dKTtcclxuICAgIHRvdGFsICs9IChjYXJ0W2l0ZW1dLnF0eSAqIGNhcnRbaXRlbV0ucHJpY2UpO1xyXG4gICAgIHRvdGFsUSArPSAoY2FydFtpdGVtXS5xdHkgKiAxKTtcclxuICB9XHJcbmRpc3BsYXlDYXJ0LnRvdGFsID0gdG90YWw7XHJcblxyXG5cclxuICB2YXIgdG90YWxRdHkgPSB0b3RhbFE7XHJcblxyXG4gIHJlcy5yZW5kZXIoJ2NoZWNrb3V0JywgeyB0aXRsZTogJ0UtQ29tbWVyY2UgfHwgQ2hlY2tvdXQnLCBlbWFpbDogcmVxLmNvb2tpZXMuZW1haWwsIGNhcnQ6IGNhcnQsIHRvdGFsUXR5OiB0b3RhbFF0eSwgY2FydFRvdGFsOiB0b3RhbCwgbmFtZWU6IHJlcS5jb29raWVzLmNjLCBxdWFudDogcmVxLmNvb2tpZXMucXVhbnR9KTtcclxuICBjb25zb2xlLmxvZyhjYXJ0KTtcclxufSk7XHJcblxyXG5IYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCd0b3RhbFAnLCBmdW5jdGlvbihwcmljZSwgcXR5KXtcclxuICByZXR1cm4gcHJpY2UgKiBxdHk7XHJcbn0pXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcclxuIl19