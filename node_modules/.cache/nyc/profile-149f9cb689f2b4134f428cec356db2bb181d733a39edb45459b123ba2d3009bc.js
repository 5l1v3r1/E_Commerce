function cov_1l6fuqv6hb(){var path="C:\\Users\\bolorundurovb\\Documents\\Web Projects\\E_Commerce\\routes\\profile.js";var hash="57542ce874e96c417578ef9e29618e1cdb0d8fa3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\bolorundurovb\\Documents\\Web Projects\\E_Commerce\\routes\\profile.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:13},end:{line:2,column:29}},"2":{start:{line:3,column:10},end:{line:3,column:33}},"3":{start:{line:4,column:15},end:{line:4,column:34}},"4":{start:{line:5,column:18},end:{line:5,column:40}},"5":{start:{line:9,column:11},end:{line:9,column:36}},"6":{start:{line:14,column:0},end:{line:14,column:83}},"7":{start:{line:15,column:7},end:{line:15,column:26}},"8":{start:{line:16,column:0},end:{line:16,column:62}},"9":{start:{line:17,column:0},end:{line:19,column:2}},"10":{start:{line:18,column:4},end:{line:18,column:61}},"11":{start:{line:22,column:19},end:{line:38,column:1}},"12":{start:{line:23,column:17},end:{line:23,column:45}},"13":{start:{line:25,column:15},end:{line:25,column:32}},"14":{start:{line:27,column:2},end:{line:37,column:3}},"15":{start:{line:29,column:20},end:{line:29,column:25}},"16":{start:{line:31,column:6},end:{line:31,column:24}},"17":{start:{line:32,column:6},end:{line:32,column:29}},"18":{start:{line:33,column:6},end:{line:33,column:13}},"19":{start:{line:36,column:6},end:{line:36,column:60}},"20":{start:{line:41,column:0},end:{line:87,column:3}},"21":{start:{line:42,column:2},end:{line:68,column:3}},"22":{start:{line:43,column:4},end:{line:63,column:5}},"23":{start:{line:45,column:8},end:{line:45,column:71}},"24":{start:{line:50,column:0},end:{line:58,column:3}},"25":{start:{line:52,column:2},end:{line:52,column:35}},"26":{start:{line:53,column:2},end:{line:53,column:69}},"27":{start:{line:56,column:2},end:{line:56,column:32}},"28":{start:{line:57,column:2},end:{line:57,column:22}},"29":{start:{line:61,column:8},end:{line:61,column:38}},"30":{start:{line:77,column:0},end:{line:86,column:3}},"31":{start:{line:78,column:2},end:{line:85,column:3}},"32":{start:{line:79,column:12},end:{line:79,column:26}},"33":{start:{line:82,column:10},end:{line:82,column:153}},"34":{start:{line:84,column:10},end:{line:84,column:28}},"35":{start:{line:90,column:0},end:{line:90,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:16},end:{line:17,column:17}},loc:{start:{line:17,column:34},end:{line:19,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:22,column:19},end:{line:22,column:20}},loc:{start:{line:22,column:39},end:{line:38,column:1}},line:22},"2":{name:"(anonymous_2)",decl:{start:{line:41,column:28},end:{line:41,column:29}},loc:{start:{line:41,column:48},end:{line:87,column:1}},line:41},"3":{name:"(anonymous_3)",decl:{start:{line:42,column:37},end:{line:42,column:38}},loc:{start:{line:42,column:51},end:{line:68,column:1}},line:42},"4":{name:"(anonymous_4)",decl:{start:{line:50,column:11},end:{line:50,column:12}},loc:{start:{line:50,column:41},end:{line:58,column:1}},line:50},"5":{name:"(anonymous_5)",decl:{start:{line:77,column:59},end:{line:77,column:60}},loc:{start:{line:77,column:78},end:{line:86,column:1}},line:77}},branchMap:{"0":{loc:{start:{line:27,column:2},end:{line:37,column:3}},type:"if",locations:[{start:{line:27,column:2},end:{line:37,column:3}},{start:{line:27,column:2},end:{line:37,column:3}}],line:27},"1":{loc:{start:{line:43,column:4},end:{line:63,column:5}},type:"if",locations:[{start:{line:43,column:4},end:{line:63,column:5}},{start:{line:43,column:4},end:{line:63,column:5}}],line:43},"2":{loc:{start:{line:53,column:21},end:{line:53,column:68}},type:"cond-expr",locations:[{start:{line:53,column:60},end:{line:53,column:63}},{start:{line:53,column:66},end:{line:53,column:68}}],line:53},"3":{loc:{start:{line:56,column:13},end:{line:56,column:30}},type:"binary-expr",locations:[{start:{line:56,column:13},end:{line:56,column:23}},{start:{line:56,column:27},end:{line:56,column:30}}],line:56},"4":{loc:{start:{line:78,column:2},end:{line:85,column:3}},type:"if",locations:[{start:{line:78,column:2},end:{line:85,column:3}},{start:{line:78,column:2},end:{line:85,column:3}}],line:78}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"57542ce874e96c417578ef9e29618e1cdb0d8fa3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_1l6fuqv6hb=function(){return actualCoverage;};return actualCoverage;}cov_1l6fuqv6hb();var express=(cov_1l6fuqv6hb().s[0]++,require('express'));var router=(cov_1l6fuqv6hb().s[1]++,express.Router());var jwt=(cov_1l6fuqv6hb().s[2]++,require('jsonwebtoken'));var mongoose=(cov_1l6fuqv6hb().s[3]++,require('mongoose'));var createError=(cov_1l6fuqv6hb().s[4]++,require('http-errors'));var User=(cov_1l6fuqv6hb().s[5]++,require('../models/user'));//mongodb://admin:admin1234@ds014808.mlab.com:14808/ecommerceapp
//mongodb://localhost:27017/ecommercestore
cov_1l6fuqv6hb().s[6]++;mongoose.connect('mongodb://admin:admin1234@ds014808.mlab.com:14808/ecommerceapp');var db=(cov_1l6fuqv6hb().s[7]++,mongoose.connection);cov_1l6fuqv6hb().s[8]++;db.on('error',console.log.bind(console,"connection error"));cov_1l6fuqv6hb().s[9]++;db.once('open',function(callback){cov_1l6fuqv6hb().f[0]++;cov_1l6fuqv6hb().s[10]++;console.log("Database connection succeeded for profile");});cov_1l6fuqv6hb().s[11]++;const checkToken=(req,res,next)=>{cov_1l6fuqv6hb().f[1]++;const header=(cov_1l6fuqv6hb().s[12]++,req.headers['authorization']);const heads=(cov_1l6fuqv6hb().s[13]++,req.cookies.token);cov_1l6fuqv6hb().s[14]++;if(typeof heads!=='undefined'){cov_1l6fuqv6hb().b[0][0]++;//const bearer = header.split(' ');
const token=(cov_1l6fuqv6hb().s[15]++,heads);cov_1l6fuqv6hb().s[16]++;req.token=token;cov_1l6fuqv6hb().s[17]++;console.log(req.token);cov_1l6fuqv6hb().s[18]++;next();}else{cov_1l6fuqv6hb().b[0][1]++;cov_1l6fuqv6hb().s[19]++;//If header is undefined return Forbidden (403)
res.render('./login',{message:'You need to log in'});}};/* GET home page. */cov_1l6fuqv6hb().s[20]++;router.get('/',checkToken,(req,res,next)=>{cov_1l6fuqv6hb().f[2]++;cov_1l6fuqv6hb().s[21]++;jwt.verify(req.token,'secretkey',(err,res)=>{cov_1l6fuqv6hb().f[3]++;cov_1l6fuqv6hb().s[22]++;if(err){cov_1l6fuqv6hb().b[1][0]++;cov_1l6fuqv6hb().s[23]++;//If error send Forbidden (403)
console.log('ERROR: Could not connect to the protected route');//res.sendStatus(403)
// render the error page
//res.status(err.status || 403);
// error handler
cov_1l6fuqv6hb().s[24]++;router.use(function(err,req,res,next){cov_1l6fuqv6hb().f[4]++;cov_1l6fuqv6hb().s[25]++;// set locals, only providing error in development
res.locals.message=err.message;cov_1l6fuqv6hb().s[26]++;res.locals.error=req.app.get('env')==='development'?(cov_1l6fuqv6hb().b[2][0]++,err):(cov_1l6fuqv6hb().b[2][1]++,{});// render the error page
cov_1l6fuqv6hb().s[27]++;res.status((cov_1l6fuqv6hb().b[3][0]++,err.status)||(cov_1l6fuqv6hb().b[3][1]++,403));cov_1l6fuqv6hb().s[28]++;res.render('error');});}else{cov_1l6fuqv6hb().b[1][1]++;cov_1l6fuqv6hb().s[29]++;//If token is successfully verified, we can send the autorized data 
console.log('Token verified');}});/*db.collection("users").findOne({email:req.body.email}, function(err, result) {
  if (err) throw err;
  console.log(result);
  //db.close();
  console.log("db closed");
});*/cov_1l6fuqv6hb().s[30]++;db.collection("users").findOne({email:req.cookies.email},function(err,docs){cov_1l6fuqv6hb().f[5]++;cov_1l6fuqv6hb().s[31]++;if(err){cov_1l6fuqv6hb().b[4][0]++;cov_1l6fuqv6hb().s[32]++;res.json(err);}else{cov_1l6fuqv6hb().b[4][1]++;cov_1l6fuqv6hb().s[33]++;res.render('profile',{title:'E-Commerce || Profile',docs:docs,email:req.cookies.email,namee:req.cookies.cc,quant:req.cookies.quant});cov_1l6fuqv6hb().s[34]++;console.log(docs);}});});cov_1l6fuqv6hb().s[35]++;module.exports=router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2ZpbGUuanMiXSwibmFtZXMiOlsiZXhwcmVzcyIsInJlcXVpcmUiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJqd3QiLCJtb25nb29zZSIsImNyZWF0ZUVycm9yIiwiVXNlciIsImNvbm5lY3QiLCJkYiIsImNvbm5lY3Rpb24iLCJvbiIsImNvbnNvbGUiLCJsb2ciLCJiaW5kIiwib25jZSIsImNhbGxiYWNrIiwiY2hlY2tUb2tlbiIsInJlcSIsInJlcyIsIm5leHQiLCJoZWFkZXIiLCJoZWFkZXJzIiwiaGVhZHMiLCJjb29raWVzIiwidG9rZW4iLCJyZW5kZXIiLCJtZXNzYWdlIiwiZ2V0IiwidmVyaWZ5IiwiZXJyIiwidXNlIiwibG9jYWxzIiwiZXJyb3IiLCJhcHAiLCJzdGF0dXMiLCJjb2xsZWN0aW9uIiwiZmluZE9uZSIsImVtYWlsIiwiZG9jcyIsImpzb24iLCJ0aXRsZSIsIm5hbWVlIiwiY2MiLCJxdWFudCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJnMEpBQUEsR0FBSUEsQ0FBQUEsT0FBTywwQkFBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBVixDQUFYLENBQ0EsR0FBSUMsQ0FBQUEsTUFBTSwwQkFBR0YsT0FBTyxDQUFDRyxNQUFSLEVBQUgsQ0FBVixDQUNBLEdBQUlDLENBQUFBLEdBQUcsMEJBQUdILE9BQU8sQ0FBQyxjQUFELENBQVYsQ0FBUCxDQUNBLEdBQUlJLENBQUFBLFFBQVEsMEJBQUdKLE9BQU8sQ0FBQyxVQUFELENBQVYsQ0FBWixDQUNBLEdBQUlLLENBQUFBLFdBQVcsMEJBQUdMLE9BQU8sQ0FBQyxhQUFELENBQVYsQ0FBZixDQUlBLEdBQUlNLENBQUFBLElBQUksMEJBQUdOLE9BQU8sQ0FBQyxnQkFBRCxDQUFWLENBQVIsQ0FFQTtBQUNBO3dCQUVBSSxRQUFRLENBQUNHLE9BQVQsQ0FBaUIsZ0VBQWpCLEVBQ0EsR0FBSUMsQ0FBQUEsRUFBRSwwQkFBQ0osUUFBUSxDQUFDSyxVQUFWLENBQU4sQyx3QkFDQUQsRUFBRSxDQUFDRSxFQUFILENBQU0sT0FBTixDQUFlQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsSUFBWixDQUFpQkYsT0FBakIsQ0FBMEIsa0JBQTFCLENBQWYsRSx3QkFDQUgsRUFBRSxDQUFDTSxJQUFILENBQVEsTUFBUixDQUFnQixTQUFTQyxRQUFULENBQWtCLGtEQUM5QkosT0FBTyxDQUFDQyxHQUFSLENBQVksMkNBQVosRUFDSCxDQUZELEUseUJBS0EsS0FBTUksQ0FBQUEsVUFBVSxDQUFHLENBQUNDLEdBQUQsQ0FBTUMsR0FBTixDQUFXQyxJQUFYLEdBQW9CLHlCQUNyQyxLQUFNQyxDQUFBQSxNQUFNLDJCQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWSxlQUFaLENBQUgsQ0FBWixDQUVELEtBQU1DLENBQUFBLEtBQUssMkJBQUdMLEdBQUcsQ0FBQ00sT0FBSixDQUFZQyxLQUFmLENBQVgsQ0FIc0MseUJBS3JDLEdBQUcsTUFBT0YsQ0FBQUEsS0FBUCxHQUFpQixXQUFwQixDQUFpQyw0QkFDN0I7QUFDQSxLQUFNRSxDQUFBQSxLQUFLLDJCQUFHRixLQUFILENBQVgsQ0FGNkIseUJBSTdCTCxHQUFHLENBQUNPLEtBQUosQ0FBWUEsS0FBWixDQUo2Qix5QkFLN0JiLE9BQU8sQ0FBQ0MsR0FBUixDQUFZSyxHQUFHLENBQUNPLEtBQWhCLEVBTDZCLHlCQU03QkwsSUFBSSxHQUNQLENBUEQsSUFPTyxxREFDSDtBQUNBRCxHQUFHLENBQUNPLE1BQUosQ0FBVyxTQUFYLENBQXNCLENBQUNDLE9BQU8sQ0FBQyxvQkFBVCxDQUF0QixFQUNILENBQ0YsQ0FoQkQsQ0FrQkEsb0IseUJBQ0F6QixNQUFNLENBQUMwQixHQUFQLENBQVcsR0FBWCxDQUFnQlgsVUFBaEIsQ0FBNEIsQ0FBQ0MsR0FBRCxDQUFNQyxHQUFOLENBQVdDLElBQVgsR0FBb0Isa0RBQzlDaEIsR0FBRyxDQUFDeUIsTUFBSixDQUFXWCxHQUFHLENBQUNPLEtBQWYsQ0FBc0IsV0FBdEIsQ0FBbUMsQ0FBQ0ssR0FBRCxDQUFNWCxHQUFOLEdBQWMsa0RBQy9DLEdBQUdXLEdBQUgsQ0FBTyxxREFDSDtBQUNBbEIsT0FBTyxDQUFDQyxHQUFSLENBQVksaURBQVosRUFDQTtBQUNBO0FBQ047QUFDQTtBQU5TLHlCQU9YWCxNQUFNLENBQUM2QixHQUFQLENBQVcsU0FBU0QsR0FBVCxDQUFjWixHQUFkLENBQW1CQyxHQUFuQixDQUF3QkMsSUFBeEIsQ0FBOEIsa0RBQ3ZDO0FBQ0FELEdBQUcsQ0FBQ2EsTUFBSixDQUFXTCxPQUFYLENBQXFCRyxHQUFHLENBQUNILE9BQXpCLENBRnVDLHlCQUd2Q1IsR0FBRyxDQUFDYSxNQUFKLENBQVdDLEtBQVgsQ0FBbUJmLEdBQUcsQ0FBQ2dCLEdBQUosQ0FBUU4sR0FBUixDQUFZLEtBQVosSUFBdUIsYUFBdkIsNkJBQXVDRSxHQUF2Qyw4QkFBNkMsRUFBN0MsQ0FBbkIsQ0FFQTtBQUx1Qyx5QkFNdkNYLEdBQUcsQ0FBQ2dCLE1BQUosQ0FBVyw0QkFBQUwsR0FBRyxDQUFDSyxNQUFKLCtCQUFjLEdBQWQsQ0FBWCxFQU51Qyx5QkFPdkNoQixHQUFHLENBQUNPLE1BQUosQ0FBVyxPQUFYLEVBQ0QsQ0FSRCxFQVNLLENBaEJELElBZ0JPLHFEQUNIO0FBQ0FkLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaLEVBRUgsQ0FLSixDQTFCQyxFQTRCRjs7Ozs7S0E3QmdELHlCQW9DaERKLEVBQUUsQ0FBQzJCLFVBQUgsQ0FBYyxPQUFkLEVBQXVCQyxPQUF2QixDQUErQixDQUFDQyxLQUFLLENBQUVwQixHQUFHLENBQUNNLE9BQUosQ0FBWWMsS0FBcEIsQ0FBL0IsQ0FBMkQsU0FBU1IsR0FBVCxDQUFjUyxJQUFkLENBQW1CLGtEQUM1RSxHQUFHVCxHQUFILENBQVEscURBQ0VYLEdBQUcsQ0FBQ3FCLElBQUosQ0FBU1YsR0FBVCxFQUNWLENBRkEsSUFHSyxxREFDR1gsR0FBRyxDQUFDTyxNQUFKLENBQVcsU0FBWCxDQUFzQixDQUFDZSxLQUFLLENBQUUsdUJBQVIsQ0FBaUNGLElBQUksQ0FBRUEsSUFBdkMsQ0FBNkNELEtBQUssQ0FBRXBCLEdBQUcsQ0FBQ00sT0FBSixDQUFZYyxLQUFoRSxDQUF1RUksS0FBSyxDQUFFeEIsR0FBRyxDQUFDTSxPQUFKLENBQVltQixFQUExRixDQUE4RkMsS0FBSyxDQUFFMUIsR0FBRyxDQUFDTSxPQUFKLENBQVlvQixLQUFqSCxDQUF0QixFQURILHlCQUdHaEMsT0FBTyxDQUFDQyxHQUFSLENBQVkwQixJQUFaLEVBQ1AsQ0FDRixDQVRELEVBVUMsQ0E5Q0QsRSx5QkFpREFNLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQjVDLE1BQWpCIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xyXG52YXIgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcbnZhciBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7IFxyXG52YXIgY3JlYXRlRXJyb3IgPSByZXF1aXJlKCdodHRwLWVycm9ycycpO1xyXG5cclxuXHJcblxyXG52YXIgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy91c2VyJyk7XHJcblxyXG4vL21vbmdvZGI6Ly9hZG1pbjphZG1pbjEyMzRAZHMwMTQ4MDgubWxhYi5jb206MTQ4MDgvZWNvbW1lcmNlYXBwXHJcbi8vbW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9lY29tbWVyY2VzdG9yZVxyXG5cclxubW9uZ29vc2UuY29ubmVjdCgnbW9uZ29kYjovL2FkbWluOmFkbWluMTIzNEBkczAxNDgwOC5tbGFiLmNvbToxNDgwOC9lY29tbWVyY2VhcHAnKTsgXHJcbnZhciBkYj1tb25nb29zZS5jb25uZWN0aW9uOyBcclxuZGIub24oJ2Vycm9yJywgY29uc29sZS5sb2cuYmluZChjb25zb2xlLCBcImNvbm5lY3Rpb24gZXJyb3JcIikpOyBcclxuZGIub25jZSgnb3BlbicsIGZ1bmN0aW9uKGNhbGxiYWNrKXsgXHJcbiAgICBjb25zb2xlLmxvZyhcIkRhdGFiYXNlIGNvbm5lY3Rpb24gc3VjY2VlZGVkIGZvciBwcm9maWxlXCIpOyBcclxufSlcclxuXHJcblxyXG5jb25zdCBjaGVja1Rva2VuID0gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgY29uc3QgaGVhZGVyID0gcmVxLmhlYWRlcnNbJ2F1dGhvcml6YXRpb24nXTtcclxuXHJcbiBjb25zdCBoZWFkcyA9IHJlcS5jb29raWVzLnRva2VuO1xyXG5cclxuICBpZih0eXBlb2YgaGVhZHMgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIC8vY29uc3QgYmVhcmVyID0gaGVhZGVyLnNwbGl0KCcgJyk7XHJcbiAgICAgIGNvbnN0IHRva2VuID0gaGVhZHM7XHJcblxyXG4gICAgICByZXEudG9rZW4gPSB0b2tlbjtcclxuICAgICAgY29uc29sZS5sb2cocmVxLnRva2VuKTtcclxuICAgICAgbmV4dCgpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAgIC8vSWYgaGVhZGVyIGlzIHVuZGVmaW5lZCByZXR1cm4gRm9yYmlkZGVuICg0MDMpXHJcbiAgICAgIHJlcy5yZW5kZXIoJy4vbG9naW4nLCB7bWVzc2FnZTonWW91IG5lZWQgdG8gbG9nIGluJ30pO1xyXG4gIH1cclxufVxyXG5cclxuLyogR0VUIGhvbWUgcGFnZS4gKi9cclxucm91dGVyLmdldCgnLycsIGNoZWNrVG9rZW4sIChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gIGp3dC52ZXJpZnkocmVxLnRva2VuLCAnc2VjcmV0a2V5JywgKGVyciwgcmVzKSA9PiB7XHJcbiAgICBpZihlcnIpe1xyXG4gICAgICAgIC8vSWYgZXJyb3Igc2VuZCBGb3JiaWRkZW4gKDQwMylcclxuICAgICAgICBjb25zb2xlLmxvZygnRVJST1I6IENvdWxkIG5vdCBjb25uZWN0IHRvIHRoZSBwcm90ZWN0ZWQgcm91dGUnKTtcclxuICAgICAgICAvL3Jlcy5zZW5kU3RhdHVzKDQwMylcclxuICAgICAgICAvLyByZW5kZXIgdGhlIGVycm9yIHBhZ2VcclxuICAvL3Jlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA0MDMpO1xyXG4gIC8vIGVycm9yIGhhbmRsZXJcclxucm91dGVyLnVzZShmdW5jdGlvbihlcnIsIHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgLy8gc2V0IGxvY2Fscywgb25seSBwcm92aWRpbmcgZXJyb3IgaW4gZGV2ZWxvcG1lbnRcclxuICByZXMubG9jYWxzLm1lc3NhZ2UgPSBlcnIubWVzc2FnZTtcclxuICByZXMubG9jYWxzLmVycm9yID0gcmVxLmFwcC5nZXQoJ2VudicpID09PSAnZGV2ZWxvcG1lbnQnID8gZXJyIDoge307XHJcblxyXG4gIC8vIHJlbmRlciB0aGUgZXJyb3IgcGFnZVxyXG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA0MDMpO1xyXG4gIHJlcy5yZW5kZXIoJ2Vycm9yJyk7XHJcbn0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvL0lmIHRva2VuIGlzIHN1Y2Nlc3NmdWxseSB2ZXJpZmllZCwgd2UgY2FuIHNlbmQgdGhlIGF1dG9yaXplZCBkYXRhIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdUb2tlbiB2ZXJpZmllZCcpO1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gIFxyXG4gIFxyXG4gIFxyXG5cclxufSk7XHJcblxyXG4vKmRiLmNvbGxlY3Rpb24oXCJ1c2Vyc1wiKS5maW5kT25lKHtlbWFpbDpyZXEuYm9keS5lbWFpbH0sIGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XHJcbiAgaWYgKGVycikgdGhyb3cgZXJyO1xyXG4gIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgLy9kYi5jbG9zZSgpO1xyXG4gIGNvbnNvbGUubG9nKFwiZGIgY2xvc2VkXCIpO1xyXG59KTsqL1xyXG5cclxuZGIuY29sbGVjdGlvbihcInVzZXJzXCIpLmZpbmRPbmUoe2VtYWlsOiByZXEuY29va2llcy5lbWFpbH0sIGZ1bmN0aW9uKGVyciwgZG9jcyl7XHJcbiAgaWYoZXJyKSB7XHJcbiAgICAgICAgICAgIHJlcy5qc29uKGVycik7XHJcbiB9XHJcbiAgZWxzZSB7XHJcbiAgICAgICAgICByZXMucmVuZGVyKCdwcm9maWxlJywge3RpdGxlOiAnRS1Db21tZXJjZSB8fCBQcm9maWxlJywgZG9jczogZG9jcywgZW1haWw6IHJlcS5jb29raWVzLmVtYWlsLCBuYW1lZTogcmVxLmNvb2tpZXMuY2MsIHF1YW50OiByZXEuY29va2llcy5xdWFudH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhkb2NzKTtcclxuICB9XHJcbn0pO1xyXG59KTtcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcclxuIl19